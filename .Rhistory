title = paste(m, "Status and Trends Map"),
background = "grey", selfcontained = FALSE)
}
}
source('N:/Status_and_Trend_Reports/2019/statewide_plotting2.R')
source('N:/Status_and_Trend_Reports/2019/statewide_plotting2.R')
table_format <- "pandoc"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report",
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report",
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
View(figs)
View(figs)
table_format <- "pandoc"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report",
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report",
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
View(param_sum)
table_format <- "pandoc"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report",
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report",
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
ambient_stations <- read.csv("//deqhq1/WQNPS/Status_and_Trend_Reports/OWQI/OWQIdata.csv", stringsAsFactors = FALSE, skip = 1)
ambient_stations <- unique(ambient_stations$Station)
ambient_stations <- paste0(ambient_stations, "-ORDEQ")
ambient_status <- state_param_sum %>% filter(MLocID %in% ambient_stations)
state_param_sum <- readxl::read_xlsx(path = paste0(state_project_dir, "Oregon_parameter_summary.xlsx"),
sheet = "station_summary")
state_param_sum <- readxl::read_xlsx(path = paste0("N:/Status_and_Trend_Reports/2019/", "Oregon_parameter_summary.xlsx"),
sheet = "station_summary")
state_param_sum <- state_param_sum %>% dplyr::filter(!is.na(AU_ID))
state_param_sum <- state_param_sum %>% dplyr::filter(AU_ID != "")
ambient_status <- state_param_sum %>% filter(MLocID %in% ambient_stations)
ambient_map <- parameter_summary_map(param_summary = ambient_status, au_param_summary = state_param_sum_au, area = HUC_shp)
state_param_sum_au <- readxl::read_xlsx(path = paste0("N:/Status_and_Trend_Reports/2019/", "Oregon_parameter_summary.xlsx"),
sheet = "AU_summary")
state_param_sum_au <- state_param_sum_au %>% dplyr::filter(!is.na(AU_ID))
state_param_sum_au <- state_param_sum_au %>% dplyr::filter(AU_ID != "")
ambient_status <- state_param_sum %>% filter(MLocID %in% ambient_stations)
ambient_map <- parameter_summary_map(param_summary = ambient_status, au_param_summary = state_param_sum_au, area = HUC_shp)
HUC_shp <- readOGR(dsn = "N:/Status_and_Trend_Reports/GIS", layer = 'Report_Units_HUC08', integer64="warn.loss", verbose = FALSE, stringsAsFactors = FALSE)
HUC_shp <- sf::st_as_sf(HUC_shp)
HUC_shp <- st_transform(HUC_shp, 4326)
ambient_map <- parameter_summary_map(param_summary = ambient_status, au_param_summary = state_param_sum_au, area = HUC_shp)
library(devtools)
library(rgdal)
#library(RODBC)
library(dplyr)
# devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
library(odeqstatusandtrends)
# devtools::install_github('donco/odeqassessment', host = 'https://api.github.com', upgrade='never')
library(odeqassessment)
# devtools::install_github('rmichie/wqdb/wqdb', host = 'https://api.github.com', upgrade='never')
# library(wqdb)
# devtools::install_github('rmichie/owri/owri', host = 'https://api.github.com', upgrade='never')
library(owri)
# devtools::install_github('TravisPritchardODEQ/AWQMSdata', host = 'https://api.github.com', upgrade='never')
library(AWQMSdata)
library(dataRetrieval)
library(ggplot2)
library(lubridate)
library(pbapply)
library(tidyr)
library(htmltools)
library(captioner)
library(sf)
library(leaflet)
library(leaflet.extras)
library(leaflet.esri)
library(leafem)
library(knitr)
library(mapview)
library(rmarkdown)
library(kableExtra)
library(htmlwidgets)
library(rmapshaper)
library(RODBC)
library(RSQLite)
library(htmltools)
library(Rcpp)
library(writexl)
ambient_map <- parameter_summary_map(param_summary = ambient_status, au_param_summary = state_param_sum_au, area = HUC_shp)
ambient_map
ambient_stations <- read.csv("//deqhq1/WQNPS/Status_and_Trend_Reports/OWQI/OWQIdata.csv", stringsAsFactors = FALSE, skip = 1)
ambient_stations <- unique(ambient_stations$Station)
ambient_stations <- paste0(ambient_stations, "-ORDEQ")
state_param_sum <- readxl::read_xlsx(path = paste0("N:/Status_and_Trend_Reports/2019/", "Oregon_parameter_summary.xlsx"),
sheet = "station_summary")
state_param_sum <- state_param_sum %>% dplyr::filter(!is.na(AU_ID))
state_param_sum <- state_param_sum %>% dplyr::filter(AU_ID != "")
state_param_sum_au <- readxl::read_xlsx(path = paste0("N:/Status_and_Trend_Reports/2019/", "Oregon_parameter_summary.xlsx"),
sheet = "AU_summary")
state_param_sum_au <- state_param_sum_au %>% dplyr::filter(!is.na(AU_ID))
state_param_sum_au <- state_param_sum_au %>% dplyr::filter(AU_ID != "")
ambient_status <- state_param_sum %>% filter(MLocID %in% ambient_stations)
HUC_shp <- readOGR(dsn = "N:/Status_and_Trend_Reports/GIS", layer = 'Report_Units_HUC08', integer64="warn.loss", verbose = FALSE, stringsAsFactors = FALSE)
HUC_shp <- sf::st_as_sf(HUC_shp)
HUC_shp <- st_transform(HUC_shp, 4326)
ambient_map <- parameter_summary_map(param_summary = ambient_status, au_param_summary = state_param_sum_au, area = HUC_shp)
htmlwidgets::saveWidget(ambient_map, paste0("//deqhq1/WQNPS/Status_and_Trend_Reports/OWQI/ambient_param_map.html"),
title = paste("Ambient Station Status and Trends Map"),
background = "grey", selfcontained = FALSE)
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
View(nlcd_huc8_df)
View(huc_names)
View(huc_names)
View(huc_names)
name <- "Klamath"
#Reclass the NLCD
landuse.huc8.df <- nlcd_huc8_df %>%
filter(ReportUnit %in% name) %>%
group_by(HUC_8_NAME) %>%
dplyr::summarise(WsAreaSqKm = round(sum(VALUE_11,VALUE_12,
VALUE_21,VALUE_22,VALUE_23,VALUE_24,
VALUE_31,VALUE_41,VALUE_42,VALUE_43,
VALUE_52,VALUE_71,VALUE_81,VALUE_82,
VALUE_90,VALUE_95) * 0.001),
PerUrbanWs = round(sum(VALUE_21,
VALUE_22,
VALUE_23,
VALUE_24) * 0.001 / WsAreaSqKm * 100, 1),
PerForestWs = round(sum(VALUE_41,
VALUE_42,
VALUE_43,
VALUE_90) * 0.001 / WsAreaSqKm * 100, 1),
PerAgWs = round(sum(VALUE_81,
VALUE_82) * 0.001 / WsAreaSqKm * 100, 1),
PerRangeWs = round(sum(VALUE_52,
VALUE_71) * 0.001 / WsAreaSqKm * 100, 1),
PerOtherWs = round(sum(VALUE_11,
VALUE_12,
VALUE_31,
VALUE_95) * 0.001 / WsAreaSqKm * 100, 1))
View(landuse.huc8.df)
landuse.huc8.df$HUC_8_NAME <- huc_names[match(landuse.huc8.df$HUC_8_NAME, huc_names$HUC8),]$HUC8_Name
View(landuse.huc8.df)
#Reclass the NLCD
landuse.huc8.df <- nlcd_huc8_df %>%
filter(ReportUnit %in% name) %>%
group_by(HUC_8_NAME) %>%
dplyr::summarise(WsAreaSqKm = round(sum(VALUE_11,VALUE_12,
VALUE_21,VALUE_22,VALUE_23,VALUE_24,
VALUE_31,VALUE_41,VALUE_42,VALUE_43,
VALUE_52,VALUE_71,VALUE_81,VALUE_82,
VALUE_90,VALUE_95) * 0.001),
PerUrbanWs = round(sum(VALUE_21,
VALUE_22,
VALUE_23,
VALUE_24) * 0.001 / WsAreaSqKm * 100, 1),
PerForestWs = round(sum(VALUE_41,
VALUE_42,
VALUE_43,
VALUE_90) * 0.001 / WsAreaSqKm * 100, 1),
PerAgWs = round(sum(VALUE_81,
VALUE_82) * 0.001 / WsAreaSqKm * 100, 1),
PerRangeWs = round(sum(VALUE_52,
VALUE_71) * 0.001 / WsAreaSqKm * 100, 1),
PerOtherWs = round(sum(VALUE_11,
VALUE_12,
VALUE_31,
VALUE_95) * 0.001 / WsAreaSqKm * 100, 1))
View(landuse.huc8.df)
View(huc_names)
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
View(huc_names)
table_format <- "pandoc"
out_dir <- "N:/Status_and_Trend_Reports/2019/Statewide Report"
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
# params = list(
#   basin = basin,
#   param_sum = param_sum_stn,
#   param_sum_au = param_sum_au,
#   complete_years = complete_years,
#   hucs = hucs,
#   table_format = "html"),
output_format = "word_document",
output_file = paste0("Oregon_SandT_report"),
output_dir = out_dir,
# output_dir = "C:/workspace/StatusAndTrends",
# output_dir = project_dir,
# intermediates_dir = "C:/workspace/StatusAndTrends",
# intermediates_dir = out_path,
envir = globalenv())
setwd("//deqhq1/WQNPS/Status_and_Trend_Reports/R_packages/odeq_StatusAndTrends_Package/odeqstatusandtrends")
devtools::document()
devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
st_report()
devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
# devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
library(odeqstatusandtrends)
st_report()
devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
# devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
library(odeqstatusandtrends)
st_report()
source('//deqhq1/WQNPS/Status_and_Trend_Reports/R_packages/odeq_StatusAndTrends_Package/odeqstatusandtrends/R/st_report.R')
st_report()
View(st_report)
st_report <- function(format = "word_document", table_format = "pandoc", file_name = "Oregon_SandT_report",
out_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report"){
table_format <- table_format
out_dir <- out_dir
rmarkdown::render(input = "N:/Status_and_Trend_Reports/Report_Files/st_report_files/state_summary.Rmd",
output_format = format,
output_file = file_name,
output_dir = out_dir,
envir = globalenv())
}
st_report()
table_format = "pandoc"
out_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report"
st_report()
st_report(table_format = "pandoc", out_dir = "N:/Status_and_Trend_Reports/2019/Statewide Report")
source('//deqhq1/WQNPS/Status_and_Trend_Reports/R_packages/odeq_StatusAndTrends_Package/odeqstatusandtrends/R/st_report.R')
st_report()
devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
st_report()
# devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
library(odeqstatusandtrends)
st_report()
odeqstatusandtrends::st_report()
devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
# devtools::install_github('donco/odeqstatusandtrends', host = 'https://api.github.com', upgrade='never')
library(odeqstatusandtrends)
odeqstatusandtrends::st_report()
st_report()
